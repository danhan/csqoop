sqoop import --connect jdbc:mysql://localhost/hcaschedule --username root --password zhu88jie \
--verbose \
--query "SELECT R_Service,R_Patient,CONCAT('{','[',b1,',',b2,',',b3,',',b4,']','}') AS serviceReq FROM(SELECT   R_Service, R_Patient,CONCAT( MAX(CASE   WHEN   ServiceRequirement\$TIME=0  THEN   0  ELSE -1 END), ':','[',ServiceRequirement\$days\$0,',',ServiceRequirement\$days\$1,',',ServiceRequirement\$days\$2,',',ServiceRequirement\$days\$3,',',ServiceRequirement\$days\$4,',',ServiceRequirement\$days\$5,',',ServiceRequirement\$days\$6,']')AS b1,CONCAT( MAX(CASE   WHEN   ServiceRequirement\$TIME=1  THEN   1  ELSE -1 END), ':','[',ServiceRequirement\$days\$0,',',ServiceRequirement\$days\$1,',',ServiceRequirement\$days\$2,',',ServiceRequirement\$days\$3,',',ServiceRequirement\$days\$4,',',ServiceRequirement\$days\$5,',',ServiceRequirement\$days\$6,']')  AS   b2,CONCAT(MAX(CASE   WHEN   ServiceRequirement\$TIME=2  THEN   2  ELSE -1 END), ':','[',ServiceRequirement\$days\$0,',',ServiceRequirement\$days\$1,',',ServiceRequirement\$days\$2,',',ServiceRequirement\$days\$3,',',ServiceRequirement\$days\$4,',',ServiceRequirement\$days\$5,',',ServiceRequirement\$days\$6,']')AS   b3,CONCAT(MAX(CASE   WHEN   ServiceRequirement\$TIME=3  THEN   3  ELSE -1 END), ':','[',ServiceRequirement\$days\$0,',',ServiceRequirement\$days\$1,',',ServiceRequirement\$days\$2,',',ServiceRequirement\$days\$3,',',ServiceRequirement\$days\$4,',',ServiceRequirement\$days\$5,',',ServiceRequirement\$days\$6,']')AS   b4  FROM   ServiceRequirement GROUP BY R_Patient,R_Service ) AS requirement WHERE \$CONDITIONS" \
--split-by 'R_Patient' \
--map-column-java serviceReq=String \
--hbase-table servicerequirement  --hbase-row-key 'R_Patient' \
--column-family d --target-dir /home/ubuntu/csqoop/hca \
--hbase-create-table
